<!DOCTYPE html>
<html>
<head>
  <title>Connplex Stock LED</title>
  <style>
    body {
      background: black;
      color: white;
      font-family: Consolas;
      text-align: center;
    }
    .price { font-size: 48px; color: lime; }
    .down { color: red; }
    .up { color: lime; }
  </style>
</head>
<body>

<h2 id="symbol">Loading...</h2>
<div id="price" class="price">--</div>
<div id="change"></div>

<p>
  Open: <span id="open"></span> |
  High: <span id="high"></span> |
  Low: <span id="low"></span> |
  VWAP: <span id="vwap"></span>
</p>

<p>
  NIFTY: <span id="nifty"></span> |
  SENSEX: <span id="sensex"></span>
</p>

<p id="time"></p>

<script>
const API_URL = "https://connplex-activeled.onrender.com/data";

async function loadData() {
  const res = await fetch(API_URL);
  const data = await res.json();

  const s = data.stock;

  document.getElementById("symbol").innerText = s.symbol;
  document.getElementById("price").innerText = "â‚¹" + s.price.toFixed(2);

  const change = document.getElementById("change");
  change.innerText = `${s.change} (${s.change_percent}%)`;
  change.className = s.change >= 0 ? "up" : "down";

  document.getElementById("open").innerText = s.open;
  document.getElementById("high").innerText = s.high;
  document.getElementById("low").innerText = s.low;
  document.getElementById("vwap").innerText = s.vwap;

  document.getElementById("nifty").innerText = data.index.nifty ?? "N/A";
  document.getElementById("sensex").innerText = data.index.sensex ?? "N/A";

  document.getElementById("time").innerText = "As on " + data.timestamp;
}

setInterval(loadData, 3000);
loadData();
</script>

</body>
</html>
