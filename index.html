<!DOCTYPE html>
<html>
<head>
  <title>Connplex Stock LED</title>

  <style>
  html, body {
    width: 100%;
    height: 100%;
  }

  * {
    font-weight: 900;
    -webkit-font-smoothing: none;
    text-rendering: geometricPrecision;
  }

  body {
    margin: 0;
    background: black;
    color: white;
    font-family: "Consolas", "Courier New", monospace;
    text-align: center;
  }

  .container {
    padding-top: 4vh;
  }

  /* Company Name */
  #symbol {
    font-size: 9vh;
    letter-spacing: 0.4vh;
    margin-bottom: 2vh;
  }

  /* Price row */
  .price-row {
    display: flex;
    justify-content: center;
    align-items: baseline;
    gap: 3vw;
  }

  #price {
    font-size: 18vh;
    color: #00ff66;
  }

  #change {
    font-size: 9vh;
  }

  .up { color: #00ff66; }
  .down { color: #ff3333; }

  /* Stats row */
  .stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 2vw;
    margin-top: 4vh;
    flex-wrap: nowrap;
    padding-right: 5%;
    padding-left: 5%;
  }

  .stat {
    text-align: center;
    flex: 1;
  }

  .stat-label {
    font-size: 4.5vh;
    color: #888;
    margin-bottom: 0.5vh;
  }

  .stat-value {
    font-size: 6vh;
    color: #00e5ff;
  }

  #time {
    margin-top: 3vh;
    font-size: 4vh;
    color: #777;
  }
  </style>

</head>

<body>

<div class="container">

  <div id="symbol">LOADING...</div>

  <div class="price-row">
    <div id="price">₹0.00</div>
    <div id="change">--</div>
  </div>

  <div class="stats">
    <div class="stat"><div class="stat-label">PRE</div><div id="prev" class="stat-value">--</div></div>
    <div class="stat"><div class="stat-label">OPEN</div><div id="open" class="stat-value">--</div></div>
    <div class="stat"><div class="stat-label">HIGH</div><div id="high" class="stat-value">--</div></div>
    <div class="stat"><div class="stat-label">LOW</div><div id="low" class="stat-value">--</div></div>
    <div class="stat"><div class="stat-label">CLOSE</div><div id="close" class="stat-value">--</div></div>
    <div class="stat"><div class="stat-label">VWAP</div><div id="vwap" class="stat-value">--</div></div>
    <div class="stat"><div class="stat-label">NIFTY 50</div><div id="nifty" class="stat-value">--</div></div>
    <div class="stat"><div class="stat-label">SENSEX</div><div id="sensex" class="stat-value">--</div></div>
  </div>

  <div id="time"></div>

</div>

<script>
const API_URL = "https://connplex-activeled.onrender.com/data";

async function loadData() {
  try {
    const res = await fetch(API_URL, { cache: "no-store" });
    if (!res.ok) throw new Error("API error");

    const data = await res.json();
    const s = data.stock;

    document.getElementById("symbol").innerText = s.symbol;

    document.getElementById("price").innerText = "₹" + s.price.toFixed(2);

    const changeEl = document.getElementById("change");
    changeEl.innerText = `${s.change.toFixed(2)} (${s.change_percent}%)`;
    changeEl.className = s.change >= 0 ? "up" : "down";

    document.getElementById("prev").innerText = s.prev_close;
    document.getElementById("open").innerText = s.open;
    document.getElementById("high").innerText = s.high;
    document.getElementById("low").innerText = s.low;
    document.getElementById("close").innerText = s.price;
    document.getElementById("vwap").innerText = s.vwap;

    document.getElementById("nifty").innerText =
      data.index.nifty ? data.index.nifty.toFixed(2) : "N/A";

    document.getElementById("sensex").innerText =
      data.index.sensex ? data.index.sensex.toFixed(2) : "N/A";

  } catch (err) {
    console.error(err);
    document.getElementById("symbol").innerText = "WAITING FOR DATA…";
  }
}

setInterval(loadData, 3000);
loadData();
</script>

</body>
</html>
